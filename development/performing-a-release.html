<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-11-25 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Trygve Laugstol" />
    <meta name="Date-Revision-yyyymmdd" content="20151125" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Mojo &#x2013; Performing a Release</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.4.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/mojohaus/mojohaus.github.io">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href=".././" id="bannerLeft">
                                                                                                <img src="../images/mojo_logo.png"  alt="Mojo"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href=".././" title="MojoHaus">
        MojoHaus</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Performing a Release</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2015-11-25</li>
            
                                    
    <li class="pull-right">
                      <a href="http://maven.apache.org/" class="externalLink" title="Maven">
        Maven</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Mojo</li>
                              
      <li>
  
                          <a href="../index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../plugins.html" title="Plugins">
          <span class="none"></span>
        Plugins</a>
            </li>
                
      <li>
  
                          <a href="../faq.html" title="FAQ">
          <span class="none"></span>
        FAQ</a>
            </li>
                              <li class="nav-header">Contribution</li>
                              
      <li>
  
                          <a href="../contribution/reporting-an-issue.html" title="Reporting an Issue">
          <span class="none"></span>
        Reporting an Issue</a>
            </li>
                
      <li>
  
                          <a href="../contribution/submitting-a-patch.html" title="Submitting a Patch">
          <span class="none"></span>
        Submitting a Patch</a>
            </li>
                
      <li>
  
                          <a href="../contribution/submitting-a-plugin.html" title="Submitting a Plugin">
          <span class="none"></span>
        Submitting a Plugin</a>
            </li>
                              <li class="nav-header">Development</li>
                              
      <li>
  
                          <a href="../development/guidelines.html" title="Development Guidelines">
          <span class="none"></span>
        Development Guidelines</a>
            </li>
                
      <li>
  
                          <a href="../development/process.html" title="Development Process">
          <span class="none"></span>
        Development Process</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Performing a Release</a>
          </li>
                              <li class="nav-header">The Sandbox</li>
                              
      <li>
  
                          <a href="../faq.html#what-is-the-sandbox" title="What is the Sandbox">
          <span class="none"></span>
        What is the Sandbox</a>
            </li>
                
      <li>
  
                          <a href="../using-sandbox-plugins.html" title="Using Sandbox Plugins">
          <span class="none"></span>
        Using Sandbox Plugins</a>
            </li>
                              <li class="nav-header">Sub-projects</li>
                              
      <li>
  
                          <a href="../animal-sniffer" title="Animal sniffer">
          <span class="none"></span>
        Animal sniffer</a>
            </li>
                
      <li>
  
                          <a href="../signatures" title="API Signatures">
          <span class="none"></span>
        API Signatures</a>
            </li>
                
      <li>
  
                          <a href="../extra-enforcer-rules" title="Extra enforcer rules">
          <span class="none"></span>
        Extra enforcer rules</a>
            </li>
                
      <li>
  
                          <a href="../mrm" title="Mock Repository Manager">
          <span class="none"></span>
        Mock Repository Manager</a>
            </li>
                              <li class="nav-header">Project Information</li>
                              
      <li>
  
                          <a href="../source-repository.html" title="Source Code">
          <span class="none"></span>
        Source Code</a>
            </li>
                
      <li>
  
                          <a href="../mail-lists.html" title="Mailing Lists">
          <span class="none"></span>
        Mailing Lists</a>
            </li>
                
      <li>
  
                          <a href="../irc.html" title="Internet Relay Chat">
          <span class="none"></span>
        Internet Relay Chat</a>
            </li>
                
      <li>
  
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <span class="none"></span>
        Issue Tracking</a>
            </li>
            </ul>
                
                    
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="www.mojohaus.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- $Id$ --><!--  --><!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!--  --><div class="section">
<h2><a name="Performing_a_Release"></a>Performing a Release</h2>
<p>This is a check list of stuff that has to be done before a new version of a plugin is released.</p>
<ul>
<li><a href="#Preparing_to_Release">Preparing to Release</a></li>
<li><a href="#Graduating_from_the_Sandbox">Graduating from the Sandbox</a></li>
<li><a href="#Preparing_for_the_First_Production_Release">Preparing for the First Production Release</a></li>
<li><a href="#Making_GPG_Keys">Making GPG Keys</a></li>
<li><a href="#Importing_CA_Certificates">Importing CA Certificates</a></li>
<li><a href="#Preparing_your_environment">Preparing your environment</a></li>
<li><a href="#Staging_the_Release">Staging the Release</a></li>
<li><a href="#Call_a_Vote">Call a Vote</a></li>
<li><a href="#Promoting_the_Release">Promoting the Release</a></li>
<li><a href="#Dropping_the_Release">Dropping the Release</a></li>
<li><a href="#Releasing_the_Mojo_Parent_POM">Releasing the Mojo Parent POM</a></li></ul>
<div class="section">
<h3><a name="Preparing_to_Release">Preparing to Release</a></h3>
<ul>
<li>Make sure the site documentation is up to date and follows the <a href="./guidelines.html">Development Guidelines</a>.</li>
<li>All open GitHub issues should be closed or agreed to be scheduled for a future version. </li>
<li>Plugin must be documented and preferably have unit and integration tests.</li>
<li>If <tt>changes-report</tt> of <a class="externalLink" href="http://maven.apache.org/plugins/maven-changes-plugin/">maven-changes-plugin</a> is used, update <tt>changes.xml</tt> to include all issues in GitHub that were fixed. (If <tt>github-report</tt> is used, this information is retrieved automatically from GitHub.)</li>
<li>If the release is a bugfix release (incrementing z): explicitly document the bugs fixed.</li>
<li>If the release is a minor release (incrementing y): document the new features added. Make sure that these new features are properly documented, including:
<ul>
<li>Javadoc tags if the Mojo is written in Java</li></ul></li>
<li>Make sure you include the correct information in the <tt>scm</tt> section:
<div class="source"><pre class="prettyprint">&lt;project&gt;
  &lt;scm&gt;
    &lt;connection&gt;scm:git:https://github.com/mojohaus/PLUGIN_NAME.git&lt;/connection&gt;
    &lt;developerConnection&gt;scm:git:ssh://git@github.com/mojohaus/PLUGIN_NAME.git&lt;/developerConnection&gt;
    &lt;url&gt;https://github.com/mojohaus/PLUGIN_NAME&lt;/url&gt;
  &lt;/scm&gt;
&lt;/project&gt;</pre></div>
<ul>
<li>Examples</li></ul></li>
<li>Verify that the project doesn't depend on SNAPSHOTs anymore (the <a class="externalLink" href="http://maven.apache.org/plugins/maven-release-plugin/examples/prepare-release.html">maven-release-plugin</a> will check this too)</li>
<li>Ensure the plugin complies with its intended minimum JRE requirement. For instance, if Java 1.5 is to be supported, actually set your <tt>JAVA_HOME</tt> to a JDK 1.5 and run <tt>mvn clean verify</tt>. This will catch references to classes or methods that were accidentally used but are only available in later versions of Java. Also consider to add our <a class="externalLink" href="http://www.mojohaus.org/animal-sniffer-maven-plugin/">animal-sniffer-maven-plugin</a> which can check the code against the signature of the required JDK version.</li>
<li>To <i>generate</i> the documentation of the plugin, you will need to use at least Maven 2.1.0 because of the <a class="externalLink" href="http://maven.apache.org/plugins/maven-site-plugin/">maven-site-plugin</a> preconfigured in the mojo-parent. To <i>deploy</i> you can't use Maven 2.1.0 or 2.2.0, because they produce incorrect GPG signatures and checksums respectively. This means it requires at least Maven 2.2.1 to perform a complete release. But this doesn't mean you can't use an earlier version of Maven to <i>build</i> or <i>use</i> this plugin. </li>
<li>Check that the POM properly declares its dependencies, i.e. run <tt>mvn dependency:analyze</tt> and fix any problems.</li>
<li>To be able to use the maven-release-plugin you need to have a git client available on your system path. To verify if it's there, execute <tt>git help</tt> on the project root. </li>
<li>Be sure you have generated a gpg-key before performing the release. </li></ul></div>
<div class="section">
<h3><a name="Graduating_from_the_Sandbox">Graduating from the Sandbox</a></h3>
<p>If the plugin is making its first official release, it should graduate from the sandbox. When this occurs, the following steps should be followed:</p>
<ul>
<li>Make sure the site follows the <a href="./guidelines.html">Development Guidelines</a>.</li>
<li>Call a vote for the graduation on the dev mailing list. See below for more info on how to do this. You can use a <a href="./promotevote-mailtemplate.html">template</a> for this call for promotion. </li>
<li>Ensure that you update any corresponding Continuous Integration plans to reflect the above svn location.</li>
<li>Change the POM parent from <tt>mojo-sandbox-parent</tt> to <tt>mojo-parent</tt> noting the parent's most recent version from <a class="externalLink" href="http://svn.codehaus.org/mojo/tags/">the mojo-parent svn tags folder</a>.</li>
<li>Move the plugin site link on the plugin list from the section &quot;Sandbox Plugins&quot; to &quot;Pre-release Plugins&quot; by editing the <tt><a class="externalLink" href="http://svn.codehaus.org/mojo/site/src/site/apt/plugins.apt">plugins.apt</a></tt> document. Redeploy the site and verify that it is functional.</li></ul></div>
<div class="section">
<h3><a name="Preparing_for_the_First_Production_Release">Preparing for the First Production Release</a></h3>
<p>When a plugin is ready to have its first production release (i.e. not an alpha or beta release) there are a couple of extra things that needs to be taken care of:</p>
<ul>
<li>Create a separate JIRA project for the plugin. Every production plugin must have its own JIRA project. Pre-production plugins share the MOJO project in JIRA. If you don't know how to do this, or don't have the necessary karma, just ask for help on the dev mailing list.</li>
<li>Make sure that the plugin's site passes the documentation checker plugin test. Run 
<div class="source"><pre class="prettyprint">mvn docck:check</pre></div>
<p>If there are any errors - fix them. There are a couple of errors that might not need to be fixed. As an example: it's better <i>not</i> to add an FAQ document than to add a bogus one.</p></li></ul></div>
<div class="section">
<h3><a name="Making_GPG_Keys">Making GPG Keys</a></h3>
<p>Before releasing for the first time you have to generate a GPG key and publish it. Information can also be found on Sonatype's <a class="externalLink" href="https://docs.sonatype.org/display/Repository/How+To+Generate+PGP+Signatures+With+Maven">How To Generate PGP Signatures With Maven</a>.</p>
<ul>
<li>Download GPG from <a class="externalLink" href="http://www.gnupg.org/download/">http://www.gnupg.org/download/</a> , follow the instructions and install it to your system. Verify your gpg installation by running gpg with the version flag, i.e. <tt>gpg --version</tt></li>
<li>Execute <tt>gpg --gen-key</tt> and answer the questions. Most of the time you can use the default.
<table border="1" class="table table-striped">
<tr class="a">
<td align="left">Please select what kind of key you want: (1) DSA and Elgamal (default) (2) DSA (sign only) (5) RSA (sign only)</td>
<td align="left">1</td></tr>
<tr class="b">
<td align="left">What keysize do you want? (2048)</td>
<td align="left">2048</td></tr>
<tr class="a">
<td align="left">Please specify how long the key should be valid. 0 = key does not expire <i>n</i> = key expires in n days <i>n</i>w = key expires in n weeks <i>n</i>m = key expires in n months <i>n</i>y = key expires in n years Key is valid for? (0)</td>
<td align="left">0</td></tr>
<tr class="b">
<td align="left">Key does not expire at all Is this correct? (y/N)</td>
<td align="left">y</td></tr>
<tr class="a">
<td align="left">Real name:</td>
<td align="left"><i>your real name</i></td></tr>
<tr class="b">
<td align="left">Email address:</td>
<td align="left"><i>your email address</i></td></tr>
<tr class="a">
<td align="left">Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?</td>
<td align="left">O</td></tr></table></li>
<li>Execute <tt>gpg --list-sigs &quot;</tt><i>your real name</i><tt>&quot; &amp;&amp; gpg --armor --export &quot;</tt><i>your real name</i><tt>&quot;</tt> and visit <a class="externalLink" href="http://pgp.mit.edu/">http://pgp.mit.edu/</a> to distribute your public key, so users can verify your files. This webpage contains a form where you have to copy your key. </li>
<li>Update <a class="externalLink" href="https://github.com/mojohaus/mojohaus.github.io/blob/site/src/site/resources/KEYS">https://github.com/mojohaus/mojohaus.github.io/blob/site/src/site/resources/KEYS</a> by expanding this file with your key. If you deploy the site by running <tt>mvn site:deploy</tt> the key will become available on the mojo-site. Since all mojo-developers should put their key here it's easy for users to verify mojo-artifacts. </li></ul></div>
<div class="section">
<h3><a name="Preparing_your_environment">Preparing your environment</a></h3>
<p>For any deployment you have to make contact with oss.sonatype.org, for which authentication is required. The best way to do this is to include the following sections in your personal <tt>settings.xml</tt> and fill in the <tt>oss-sonatype.username</tt> and <tt>oss-sonatype.password</tt> properties with your own credentials.</p>
<div class="source"><pre class="prettyprint">&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
          xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;ossrh-staging&lt;/id&gt; &lt;!-- used for release deployment --&gt;
      &lt;username&gt;jqhacker&lt;/username&gt; &lt;!-- oss-sonatype.username --&gt;
      &lt;password&gt;SeCrEt&lt;/password&gt; &lt;!-- oss-sonatype.password --&gt;
    &lt;/server&gt;           
    &lt;server&gt;
      &lt;id&gt;ossrh-snapshots&lt;/id&gt; &lt;!-- used for snapshot deployment --&gt;
      &lt;username&gt;jqhacker&lt;/username&gt; &lt;!-- oss-sonatype.username --&gt;
      &lt;password&gt;SeCrEt&lt;/password&gt; &lt;!-- oss-sonatype.password --&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;          </pre></div>
<p>(Note that using <a class="externalLink" href="http://maven.apache.org/guides/mini/guide-encryption.html#How_to_encrypt_server_passwords">Maven password encryption</a> is possible but may not work in combination with the <tt>oss-sonatype.password</tt> property, perhaps due to difficulties with brace expansion. Instead, duplicate your encrypted password into each of the <tt>server</tt> sections.)</p></div>
<div class="section">
<h3><a name="Staging_the_Release">Staging the Release</a></h3>
<p>The release process should be done using the <a class="externalLink" href="http://maven.apache.org/plugins/maven-release-plugin/">Maven Release Plugin</a>:</p>
<ul>
<li>Execute <tt>mvn release:prepare</tt>
<p>This will make sure all code is checked in, tag the release and make sure the POM has no snapshot dependencies. Make sure that you are able to push changes and tags via SSH</p></li>
<li>Execute <tt>mvn release:perform</tt>
<p>This will build the plugin, javadocs and source. Everything will be deployed to the Nexus Repository Manager, ready to be staged. <b>Be aware, that the site will be built and deployed as well</b>. This means the site will up to date before the voting has even started. Trying to update the site afterwards seems to be much more complicated, this way we can assure the site will reflect the intended version. </p></li>
<li>Verify that the plugin site deployment occurred successfully.</li>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Close&quot; the staging repository.</li></ul></div>
<div class="section">
<h3><a name="Call_a_Vote">Call a Vote</a></h3>
<p>Before a release can occur, a vote typically takes place. This is initiated with an email to the <a class="externalLink" href="mailto:mojohaus-dev@googlegroups.com">dev list</a>, preferrably with a subject that starts with <tt>[VOTE]</tt>. Explain the plugin, status and any other info you feel relevant. The standard is to wait 72 hours for responses. This gives other developers time to verify the quality of the plugin before placing their vote. See the <a class="externalLink" href="http://www.apache.org/foundation/voting.html">Apache Voting Guidelines</a> for more information. You can use a <a href="./releasevote-mailtemplate.html">template</a> to be sure your email contains all the expected information.</p></div>
<div class="section">
<h3><a name="Promoting_the_Release">Promoting the Release</a></h3>
<p>When the vote has passed, do the following:</p>
<ul>
<li>Reply to the latest vote and summarize the result and prefix the subject with <b>[RESULT]</b>.</li>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Release&quot; the staging repository.</li>
<li>Wait some time and find the artifacts synced on central. The synchronization typically occurs every 4 hours but allow for it take up to 24 hrs.</li>
<li>Update the <tt><a class="externalLink" href="https://github.com/mojohaus/mojohaus.github.io/blob/site/src/site/apt/plugins.apt">plugins.apt</a></tt> document to reflect the new release.</li>
<li>Record the release date for the version in the plugin's GitHub project and create a new version for future development/issues.</li>
<li>Send out an annoucement email to <a class="externalLink" href="mailto:mojohaus-dev@googlegroups.com">mojohaus-dev@googlegroups.com</a> and <a class="externalLink" href="mailto:users@maven.apache.org">users@maven.apache.org</a>. You can use a <a href="./announcement-mailtemplate.html">template</a> to be sure your email contains all the expected information. Ensure you've subscribed to all these mailing lists, otherwise the message will be bounced.</li>
<li>TODO: if there's a feed containing all releases, get the release into that feed.</li></ul></div>
<div class="section">
<h3><a name="Dropping_the_Release">Dropping the Release</a> </h3>
<p>If the vote failed, the following steps have to be taken:</p>
<ul>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Drop&quot; the staging repository.</li>
<li>Rollback any SCM-changes. Be aware that the <tt>release:rollback</tt> doesn't remove the tag. You must do this by hand, use <tt>git tag -d myplugin-1.2.3</tt>.</li>
<li>To remove a remote tag on GitHub, use <tt>git push origin :refs/tags/myplugin-1.2.3</tt></li>
<li>Run <tt>siteskinner:skin -DsiteDeploy</tt> to restore the documention of the latest released plugin.</li></ul></div>
<div class="section">
<h3><a name="Releasing_the_Mojo_Parent_POM">Releasing the Mojo Parent POM</a></h3>
<p>Of course, to release the Mojo Parent POM, a vote takes place just for an ordinary plugin release. But when it comes to actually perform the release, there are some differences to watch out for:</p>
<ol style="list-style-type: decimal">
<li>Execute <tt>mvn release:prepare</tt></li>
<li>Execute <tt>mvn release:perform -Dgoals=deploy</tt>
<p>The important thing to note here is the parameter <tt>-Dgoals=deploy</tt>. By default, the Release Plugin would execute the phases <tt>deploy</tt> and <tt>site-deploy</tt> on the parent POM. However, the site of the parent POM is not meant to be deployed, we have a separate project for this. The configuration of the site distribution in the parent POM exists solely for the purpose of inheritance by the plugins. Accidentally deploying the parent's site would damage the Mojo website, most notably the <tt>index.html</tt>.</p></li>
<li>Test that the new parent is working
<p>Manually update (without committing) one or two plugins on your local machine to use the new parent. Then run:</p>
<p><tt>mvn clean verify site -Pmojo-release</tt></p></li>
<li>Update the <a href="./guidelines.html">Development Guidelines</a> to indicate the new POM version.</li></ol></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2015.
          All rights reserved.      
                    
      </p>
                </div>

        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="https://www.ohloh.net/p/5211/widgets/project_thin_badge.js"></script>
    </div>
        </div>
    </footer>
        </body>
</html>